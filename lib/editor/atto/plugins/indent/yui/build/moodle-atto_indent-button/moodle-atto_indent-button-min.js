YUI.add("moodle-atto_indent-button",function(e,t){e.namespace("M.atto_indent").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{initializer:function(){this.addButton({icon:"e/decrease_indent",title:"outdent",buttonName:"outdent",callback:this.outdent}),this.addButton({icon:"e/increase_indent",title:"indent",buttonName:"indent",callback:this.indent})},indent:function(){var t=rangy.saveSelection();this.editor.all(".rangySelectionBoundary").setStyle("display",null),this.editor.all("blockquote").addClass("pre-existing"),document.execCommand("indent",!1,null),this.editor.all("blockquote").addClass("editor-indent"),this.editor.all(".pre-existing").removeClass("editor-indent"),this.editor.all('blockquote[class="pre-existing"]').removeAttribute("class"),this.editor.all("blockquote.pre-existing").removeClass("pre-existing");var n=e.one("body.dir-ltr")?"marginLeft":"marginRight";this.editor.all("blockquote.editor-indent").setStyle(n,"30px"),this.replaceTags(this.editor.all("blockquote.editor-indent"),"div"),rangy.restoreSelection(t),rangy.removeMarkers(t),this.markUpdated()},outdent:function(){var t=rangy.saveSelection();this.editor.all(".rangySelectionBoundary").setStyle("display",null),this.editor.all("blockquote").addClass("pre-existing"),this.replaceTags(this.editor.all(".pre-existing"),"div"),this.replaceTags(this.editor.all(".editor-indent"),"blockquote"),this.editor.all("blockquote").removeAttribute("style"),this.editor.all("blockquote").removeAttribute("class"),window.rangy.restoreSelection(t),t=window.rangy.saveSelection(),this.editor.all(".rangySelectionBoundary").setStyle("display",null),this.divideBlockquotes(),window.rangy.restoreSelection(t),document.execCommand("outdent",!1,null),t=window.rangy.saveSelection(),this.editor.all(".rangySelectionBoundary").setStyle("display",null),this.mergeBlockquotes(),this.editor.all("blockquote").addClass("editor-indent");var n=e.one("body.dir-ltr")?"marginLeft":"marginRight";this.editor.all("blockquote.editor-indent").setStyle(n,"30px"),this.replaceTags(this.editor.all("blockquote.editor-indent"),"div"),this.replaceTags(this.editor.all(".pre-existing"),"blockquote"),this.editor.all('[class="pre-existing"]').removeAttribute("class"),this.editor.all(".pre-existing").removeClass("pre-existing"),rangy.restoreSelection(t),rangy.removeMarkers(t),this.markUpdated()},replaceTags:function(t,n){t.setAttribute("data-iterate",!0);var r=this.editor.one('[data-iterate="true"]');while(r){var i=e.Node.create("<"+n+" />").setAttrs(r.getAttrs()).removeAttribute("data-iterate");r.getAttribute("style")&&i.setAttribute("style",r.getAttribute("style")),r.getAttribute("class")&&i.setAttribute("class",r.getAttribute("class"));var s=r.getDOMNode().childNodes,o;o=s[0];while(typeof o!="undefined")i.append(o),o=s[0];r.replace(i),r=this.editor.one('[data-iterate="true"]')}},divideBlockquotes:function(){e.one(this.get("host").getSelectionParentNode()).ancestor().all("blockquote").each(function(e){var t=e.getDOMNode().childNodes;while(t.length>1){var n=e.cloneNode(!1);e.ancestor().insertBefore(n,e),n.append(t[0])}})},mergeBlockquotes:function(){e.one(this.get("host").getSelectionParentNode()).ancestor().all("blockquote").each(function(e){var t=e.getDOMNode().nextSibling;while(t&&t.tagName==="blockquote"){var n=e.getDOMNode().childNodes;while(n.length>0)e.append(n[0]);t.remove(),t=e.getDOMNode().nextSibling}})}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});
